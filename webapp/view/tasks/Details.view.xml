<mvc:View controllerName="kms.controller.tasks.Detail"
    xmlns="sap.uxap"
    xmlns:layout="sap.ui.layout"
    xmlns:m="sap.m"
    xmlns:tnt="sap.tnt"
    xmlns:forms="sap.ui.layout.form"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:dataHelp="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    core:require="{ formatMessage: 'sap/base/strings/formatMessage', commonFormatter: 'kms/common/Formatters' }">
    <ObjectPageLayout showFooter="true">
        <headerTitle>
            <ObjectPageDynamicHeaderTitle>
                <expandedHeading>
                    <m:Title text="{i18n>approvalRequest}" wrapping="true" />
                </expandedHeading>
                <expandedContent>
                    <m:VBox>
                        <m:Label
                            text="{
                                parts: [
                                    {path: 'oneWay>/task/artifactType'},
                                    {path: 'oneWay>/task/actionType'},
                                    {path: 'oneWay>/task/artifactName'}
                                ],
                                formatter: 'commonFormatter.formatActionAndArtifact'
                            }" />
                        <m:HBox justifyContent="Start" alignContent="Center" alignItems="Center">
                            <m:Label text="{oneWay>/task/id}" />
                            <m:Button icon="sap-icon://copy" type="Transparent"
                                class="sapUiTinyMarginBegin sapUiTinyMarginBottom"
                                dataHelp:textToCopy="{oneWay>/task/id}"
                                press="onCopyToClipboardPress">
                                <m:customData>
                                    <core:CustomData
                                        key="testId"
                                        value="taskDetail-copyIdButton"
                                        writeToDom="true" />
                                </m:customData>
                            </m:Button>
                        </m:HBox>
                    </m:VBox>
                </expandedContent>
                <actions>
                    <m:Button icon="sap-icon://refresh"
                        type="Transparent"
                        press="onRefresh">
                        <m:customData>
                            <core:CustomData
                                key="testId"
                                value="taskDetail-refreshButton"
                                writeToDom="true" />
                        </m:customData>
                    </m:Button>
                    <m:Button
                        icon="sap-icon://decline"
                        type="Transparent"
                        press="onCancel">
                        <m:customData>
                            <core:CustomData
                                key="testId"
                                value="taskDetail-cancelButton"
                                writeToDom="true" />
                        </m:customData>
                    </m:Button>
                </actions>
            </ObjectPageDynamicHeaderTitle>
        </headerTitle>
        <sections>
            <ObjectPageSection titleUppercase="false" id="taskDetails"
                title="{i18n>details}" showTitle="false">
                <subSections>
                    <ObjectPageSubSection>
                        <m:VBox>
                            <core:Fragment
                                fragmentName="kms.resources.fragments.tasks.DetailsForm"
                                type="XML" />
                        </m:VBox>
                    </ObjectPageSubSection>
                </subSections>
            </ObjectPageSection>
            <ObjectPageSection titleUppercase="false" id="taskApproversDetails"
                title="{i18n>approvers}" showTitle="false">
                <subSections>
                    <ObjectPageSubSection>
                        <m:VBox>
                            <core:Fragment
                                fragmentName="kms.resources.fragments.tasks.ApproversDetailsForm"
                                type="XML" />
                            <m:MessageStrip
                                visible="{parts: ['oneWay>/task/state'], formatter: '.checkMinApproverAttentionRequired'}"
                                type="Warning"
                                showCloseButton="false"
                                text="{i18n>approversMinApproverAttentionMessage}">
                            </m:MessageStrip>
                        </m:VBox>
                    </ObjectPageSubSection>
                </subSections>
            </ObjectPageSection>
        </sections>
        <footer>
            <m:OverflowToolbar
                visible="{= ${oneWay>/taskTransitionActions}.length !== 0 &amp;&amp; ${roleBasedAccess>/keyConfig/canManage} }">
                <m:ToolbarSpacer />
                <m:HBox items="{oneWay>/taskTransitionActions}">
                    <m:Button class="sapUiTinyMarginBegin"
                        type="{oneWay>buttonType}"
                        text="{oneWay>text}"
                        press='.onTaskActionPress($event, ${oneWay>key})'>
                        <m:customData>
                            <core:CustomData
                                key="testId"
                                value="taskDetail-actionButton}"
                                writeToDom="true" />
                        </m:customData>
                    </m:Button>
                </m:HBox>
            </m:OverflowToolbar>
        </footer>
    </ObjectPageLayout>
</mvc:View>